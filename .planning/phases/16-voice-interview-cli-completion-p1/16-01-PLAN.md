---
phase: 16-voice-interview-cli-completion-p1
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli/voice-interview.ts
autonomous: true
requirements: [C5, M10]

must_haves:
  truths:
    - User can submit answers to interview questions via CLI
    - CLI shows next questions after submitting answers (auto-continue)
    - User can complete the interview and save voice profile
    - Progress is always visible ("Phase 1/5 • Question 3/7")
    - Error messages are friendly and descriptive
  artifacts:
    - path: "src/cli/voice-interview.ts"
      provides: "Interview submit and complete commands"
      exports: ["submitAnswers", "completeInterview", "startInterview"]
      min_lines: 170
  key_links:
    - from: "src/cli/voice-interview.ts"
      to: "src/voice/interview.ts"
      via: "processAnswer, finalizeProfile imports"
      pattern: "processAnswer|finalizeProfile"
---

<objective>
Add interactive CLI subcommands for submitting interview answers and completing the interview.

Purpose: Enable users to complete voice interviews via CLI commands with auto-advancing questions and progress feedback.

Output: Extended voice-interview.ts with "submit" and "complete" subcommands.
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Locked decisions from CONTEXT.md
- Submit: Interactive prompt asking "What's your answer for [question]?"
- Auto-advance: Show next questions after submitting answers
- Complete: Interactive prompt for save path if multiple interviews exist
- Output: Human-readable messages, progress, confirmations (not JSON-only)
- Errors: Friendly error messages describing what went wrong and how to fix
- Validation: Real-time validation of each answer before accepting (reprompt if invalid)
- Progress: Always visible — show "Phase 1/5 • Question 3/7" on each prompt

@src/cli/voice-interview.ts
@src/voice/interview.ts
</context>

<tasks>

<task type="auto">
  <name>Add interactive prompt for answer submission</name>
  <files>src/cli/voice-interview.ts</files>
  <action>
Add a "submit" subcommand to the CLI entry point that:
1. Loads the current interview state from file (if exists, else start fresh)
2. Generates questions for current phase using generateQuestions()
3. For each unanswered question, prompts: "What's your answer for [question text]?"
   - Use Node's readline.createInterface() for simple stdin input (no heavy dependencies)
   - Show progress: "Phase [N]/[total] • Question [i]/[n]"
   - Display question text and hint (if exists)
4. Collects all answers into a Record<string, string>
5. Calls processAnswer() for each answer to update state
6. Auto-advances to next phase when current questions exhausted
7. Saves updated state after submission (prepare for state persistence in 16-02)
8. Outputs next questions or completion message in human-readable format

Error handling:
- If state file corrupted, show: "Interview state is corrupted. Delete .interview.json and restart."
- If validation fails (e.g., required answer missing), reprompt the question
- Keep all output human-readable, not JSON-only

Do NOT use @clack/prompts or inquirer.js (research recommends avoiding heavy dependencies).
Use Node's built-in readline module for simple prompts.

Reference existing patterns from @src/voice/interview.ts (processAnswer, generateQuestions, finalizeProfile).
  </action>
  <verify>Run `bun run src/cli/voice-interview.ts submit` and verify it prompts for answers, shows progress, and auto-advances</verify>
  <done>CLI accepts answers interactively, shows "Phase 1/5 • Question 3/7" progress, and advances to next phase</done>
</task>

<task type="auto">
  <name>Add complete command with profile saving</name>
  <files>src/cli/voice-interview.ts</files>
  <action>
Add a "complete" subcommand to the CLI entry point that:
1. Loads the current interview state from file
2. Validates that interview is in "review" phase (complete)
3. Calls finalizeProfile() to convert state to VoiceProfile
4. Prompts for save path: "Save voice profile to [default path]:"
   - Default: "content/voice/personal.yaml" for personal hub
   - Accept user input or default with Enter key
5. Calls saveProfile() to write YAML file
6. Generates strategy via generateStrategy() if pillars exist
7. Saves strategy to "content/voice/strategy.yaml"
8. Outputs success message: "Voice profile saved to [path]. Strategy saved to [path]."
9. Cleans up interview state file (.interview.json deleted on completion)

Error handling:
- If interview not in review phase, show: "Interview not complete. Run 'submit' to finish questions."
- If save fails, show: "Failed to save profile: [error]. Check write permissions."

If multiple interview files exist (e.g., .interview-{timestamp}.json), list them and prompt: "Which interview to complete? [1-N]:"

Reference existing patterns from @src/voice/profile.ts (saveProfile, generateStrategy, saveStrategy).
  </action>
  <verify>Run `bun run src/cli/voice-interview.ts complete` after completing all questions and verify profile YAML is saved</verify>
  <done>Voice profile saved to content/voice/personal.yaml, strategy saved to content/voice/strategy.yaml, interview state cleaned up</done>
</task>

</tasks>

<verification>
- submit subcommand accepts answers interactively with readline prompts
- Progress indicator shows "Phase X/Y • Question A/B" format
- Auto-advance moves to next phase when current questions exhausted
- complete subcommand saves profile and strategy YAML files
- Error messages are human-readable and actionable
- Interview state file is deleted after completion
</verification>

<success_criteria>
Users can complete voice interview end-to-end via CLI commands: `submit` to answer questions, `complete` to save profile.
</success_criteria>

<output>
After completion, create `.planning/phases/16-voice-interview-cli-completion-p1/16-01-SUMMARY.md`
</output>
