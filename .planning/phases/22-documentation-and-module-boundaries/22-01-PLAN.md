---
phase: 22-documentation-and-module-boundaries
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - CLAUDE.md
  - src/platforms/CLAUDE.md
  - src/core/CLAUDE.md
autonomous: true
requirements: [DOC-01, DOC-02, ARCH-06]

must_haves:
  truths:
    - "A Claude agent opening the project cold can read CLAUDE.md and understand what the project does, who uses it, and the top-level data flow in under 30 seconds"
    - "CLAUDE.md contains an ASCII flow diagram showing the architecture"
    - "src/platforms/CLAUDE.md tells an agent what this module owns and lists all key files"
    - "src/core/CLAUDE.md tells an agent what this module owns and lists all key files"
    - "No CLAUDE.md file contains tooling rules, env var lists, or extension recipes"
  artifacts:
    - path: "CLAUDE.md"
      provides: "Root navigation map + architecture narrative"
      contains: "ASCII flow diagram"
    - path: "src/platforms/CLAUDE.md"
      provides: "Platforms module orientation"
      contains: "Ownership section and Key Files section"
    - path: "src/core/CLAUDE.md"
      provides: "Core module orientation"
      contains: "Ownership section and Key Files section"
  key_links:
    - from: "CLAUDE.md"
      to: "src/platforms/CLAUDE.md and src/core/CLAUDE.md"
      via: "Module Map table listing @psn/platforms and @psn/core aliases"
      pattern: "@psn/platforms.*@psn/core"
---

<objective>
Create three CLAUDE.md files: the root project navigation map and two module-level orientation files for `src/platforms/` and `src/core/`.

Purpose: A Claude agent opening this project cold should orient within seconds — understanding what the system does, the data flow, and where to find things. These files are the agent's entry point.

Output: `CLAUDE.md` (root), `src/platforms/CLAUDE.md`, `src/core/CLAUDE.md`
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-documentation-and-module-boundaries/CONTEXT.md
@.planning/phases/22-documentation-and-module-boundaries/22-RESEARCH.md
@.planning/phases/21-foundation-and-architecture-cleanup/21-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create root CLAUDE.md</name>
  <files>CLAUDE.md</files>
  <action>
Create `/home/hybridz/Projects/post-shit-now/CLAUDE.md` from scratch. CLAUDE.md does NOT currently exist.

The file must contain:

1. A `# Post Shit Now` heading
2. A 2-3 sentence Project Overview: what this repo is (Claude Code-first social media growth system), who uses it (teams who want to post consistently without it feeling like work), and the core value (make it so easy to create and post high-quality voice-matched content that team members who rarely post start posting consistently).
3. An `## Architecture` section with an ASCII flow diagram showing the top-level data flow:

```
slash command → trigger task → publisher-factory → platform handler → platform client → API
                                      ↓
                               Neon Postgres (analytics, posts, series, teams)
```

4. A `## Module Map` section — a table mapping path aliases to directories and their responsibility:

| Alias | Path | Responsibility |
|-------|------|----------------|
| @psn/core | src/core/ | Shared types, DB connection, crypto utils |
| @psn/platforms | src/platforms/ | Platform handlers + PlatformPublisher contract |
| @psn/trigger | src/trigger/ | Trigger.dev scheduled tasks |

After the table, a brief (1-sentence each) description of the other top-level src/ directories without aliases:
- `src/voice/` — voice profile management, interview engine, content generation
- `src/series/` — series tracking and episode sequencing
- `src/approval/` — approval workflow types and state machine
- `src/notifications/` — WhatsApp/email notification dispatching
- `src/team/` — team registry, invite codes, member roles
- `src/media/` — image generation and media upload helpers

5. A `## Commands` section listing the available slash commands (read the `.claude/commands/` directory to list them accurately by name and one-line description).

DO NOT include:
- How to run tests
- How to add a new platform (no extension recipes)
- Env var lists
- Tooling rules (file size limits, lint settings) — those live in biome.json and tsconfig.json
- Any section that repeats what tooling already surfaces

Target: ~100 lines. Stay under 200.
  </action>
  <verify>
    <automated>wc -l /home/hybridz/Projects/post-shit-now/CLAUDE.md && grep -c "trigger task" /home/hybridz/Projects/post-shit-now/CLAUDE.md</automated>
  </verify>
  <done>CLAUDE.md exists, is under 200 lines, contains the ASCII architecture flow diagram, and has the Module Map table with @psn aliases</done>
</task>

<task type="auto">
  <name>Task 2: Create module-level CLAUDE.md files for platforms/ and core/</name>
  <files>
    src/platforms/CLAUDE.md
    src/core/CLAUDE.md
  </files>
  <action>
Create two module CLAUDE.md files. Both follow the identical two-section structure:

```markdown
## Ownership

[One paragraph: what this module is responsible for, and what it is NOT responsible for]

## Key Files

- `relative/path/to/file.ts` — one-line description of what it does
```

No recipes, no rules, no examples. ~50 lines each.

**src/platforms/CLAUDE.md:**

Ownership paragraph: This module owns all platform-specific publish logic. It is responsible for: implementing the PlatformPublisher contract for X, LinkedIn, Instagram, and TikTok; maintaining platform clients and OAuth flows; exposing the handler factory. It is NOT responsible for: deciding which platforms a post targets (that is the orchestrator's job in src/trigger/), storing analytics or post records (that is src/core/db/), or generating content (that is src/voice/).

Key Files — list all meaningful files found in `src/platforms/` and its subdirectories. Read the directory to enumerate them accurately. Include:
- `handlers/index.ts` — barrel; importing this file registers all four handlers as a side-effect
- `handlers/x.handler.ts` — X (Twitter) platform handler implementing PlatformPublisher
- `handlers/linkedin.handler.ts` — LinkedIn handler (text, document, image, article formats)
- `handlers/instagram.handler.ts` — Instagram handler (reels, carousels, images via container workflow)
- `handlers/tiktok.handler.ts` — TikTok handler (video upload, photo posts)
- Each platform subdirectory's client.ts, media.ts, oauth.ts, types.ts (with appropriate one-liners)

**src/core/CLAUDE.md:**

Ownership paragraph: This module owns the shared foundation used by all other modules. It is responsible for: the PlatformPublisher interface definition and behavioral contracts; DB connection management and schema; shared types (Platform, PlatformPublishResult, PostMetadata, etc.); the publisher-factory (handler registration and creation); and utility functions (crypto, thread-splitting, timezone). It is NOT responsible for: platform-specific logic (that is src/platforms/), slash command orchestration (that is .claude/commands/), or Trigger.dev task definitions (that is src/trigger/).

Key Files — list all meaningful files found in `src/core/` and its subdirectories. Read the directory. Include:
- `types/publisher.ts` — PlatformPublisher interface with full behavioral contracts (preconditions, postconditions, error conventions)
- `types/index.ts` — Platform union type, PlatformPublishResult, PostMetadata, PostStatus, and other shared type definitions
- `utils/publisher-factory.ts` — Handler registration registry and createHandler/registerHandler/hasHandler/registeredPlatforms/unregisterHandler functions
- `db/connection.ts` — createHubConnection (Neon HTTP driver, serverless-safe)
- `db/schema.ts` — Drizzle schema for all 14 database tables
- `utils/crypto.ts` — encrypt/decrypt/keyFromHex for AES-256 token storage
- `utils/thread-splitter.ts` — splits long-form content into tweet-sized thread segments
- Other files in db/ and utils/ with accurate one-liners
  </action>
  <verify>
    <automated>wc -l /home/hybridz/Projects/post-shit-now/src/platforms/CLAUDE.md /home/hybridz/Projects/post-shit-now/src/core/CLAUDE.md && grep "## Ownership" /home/hybridz/Projects/post-shit-now/src/platforms/CLAUDE.md && grep "## Key Files" /home/hybridz/Projects/post-shit-now/src/core/CLAUDE.md</automated>
  </verify>
  <done>Both src/platforms/CLAUDE.md and src/core/CLAUDE.md exist, each under 70 lines, each with exactly two sections (Ownership and Key Files). No extension recipes or tooling rules present.</done>
</task>

</tasks>

<verification>
- `CLAUDE.md` exists and is under 200 lines
- `src/platforms/CLAUDE.md` exists and is under 70 lines
- `src/core/CLAUDE.md` exists and is under 70 lines
- All three files contain the required sections per CONTEXT.md locked decisions
- `grep -r "file size" CLAUDE.md src/*/CLAUDE.md` returns no matches (no tooling rules in docs)
- `grep -r "extension recipes\|how to add" CLAUDE.md src/*/CLAUDE.md` returns no matches
</verification>

<success_criteria>
- Root CLAUDE.md exists with ASCII flow diagram and Module Map table
- src/platforms/CLAUDE.md and src/core/CLAUDE.md exist with Ownership + Key Files sections
- No CLAUDE.md file duplicates tooling rules or contains extension recipes
- An agent reading only CLAUDE.md can understand what PSN is and how to navigate the codebase
</success_criteria>

<output>
After completion, create `.planning/phases/22-documentation-and-module-boundaries/22-01-SUMMARY.md`
</output>
