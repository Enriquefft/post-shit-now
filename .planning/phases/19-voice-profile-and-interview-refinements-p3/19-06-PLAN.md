---
phase: 19-voice-profile-and-interview-refinements-p3
plan: 06
type: execute
wave: 2
depends_on: [19-04]
files_modified: [src/voice/interview.ts, .claude/commands/psn/voice.md]
autonomous: true
requirements: [m7]

must_haves:
  truths:
    - "Platform persona answers are integrated into VoiceProfile"
    - "Users can configure unique voices per platform"
    - "Documentation explains platform persona interview flow"
  artifacts:
    - path: "src/voice/interview.ts"
      provides: "Platform persona integration in finalizeProfile"
      exports: ["finalizeProfile"]
    - path: ".claude/commands/psn/voice.md"
      provides: "Documentation for platform persona interview"
  key_links:
    - from: "src/voice/interview.ts"
      to: "src/voice/types.ts"
      via: "PlatformPersona type for validation"
      pattern: "platformPersonaSchema"
    - from: ".claude/commands/psn/voice.md"
      to: "src/voice/interview.ts"
      via: "Documentation of platform persona interview"
      pattern: "platform personas"
---

<objective>
Integrate platform persona answers into profile generation and update documentation.

Purpose: Complete platform persona feature by building personas from interview answers and documenting the flow.
Output: Platform personas in VoiceProfile and updated documentation
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@src/voice/types.ts (PlatformPersona schema with tone, formatPreferences, hashtagStyle, emojiUsage)
@src/voice/interview.ts (finalizeProfile function and PLATFORM_QUESTIONS)
@.claude/commands/psn/voice.md
@.planning/phases/08-instagram-tiktok-and-engagement/08-05-PLAN.md (platform-specific content guidance)
</context>

<tasks>

<task type="auto">
  <name>Integrate platform answers into profile</name>
  <files>src/voice/interview.ts</files>
  <action>
    Update finalizeProfile function to build platform personas from interview answers:

    1. For each platform, build PlatformPersona object from answers
    2. Map platform select option to platform key (x, linkedin, instagram, tiktok)
    3. Extract tone, formatPreferences, hashtagStyle, emojiUsage from answers
    4. Use defaults if not provided

    Platform persona mapping:
    ```typescript
    const platforms: Record<string, PlatformPersona> = {};

    if (selectedPlatforms.includes("X (Twitter)")) {
      platforms.x = {
        tone: state.answers.get("x_tone") || "casual",
        formatPreferences: parseMultiChoice(state.answers.get("x_format")) || ["thread"],
        hashtagStyle: state.answers.get("x_hashtags") || "minimal",
        emojiUsage: state.answers.get("x_emoji") || "rare"
      };
    }
    // Similar for LinkedIn, Instagram, TikTok...
    ```

    Include platforms object in generated VoiceProfile.

    Follow existing answer parsing pattern (pillars from comma-separated string).
    Provide sensible defaults for missing answers.
  </action>
  <verify>grep -A10 "export function finalizeProfile" src/voice/interview.ts | grep -q "platforms"</verify>
  <done>Platform persona answers integrated into profile generation with defaults</done>
</task>

<task type="auto">
  <name>Update voice.md documentation</name>
  <files>.claude/commands/psn/voice.md</files>
  <action>
    Update /psn:voice edit section to document platform persona interview:

    Add under "3. Platform personas" section:
    "The interview now guides you through configuring platform-specific voices:
    - Platform selection: Choose which platforms to post on
    - For each platform: Configure tone, format preferences, hashtag style, emoji usage
    - Platform-specific guidance provided with examples
    - Skip platforms you don't use â€” can add later via edit"

    This explains the new platform persona interview flow to users.

    Also add to /psn:voice interview section:
    "Platform personas: After basic interview, you'll configure unique voices for each platform.
    This ensures content fits platform norms (hashtags, emojis, tone)."
  </action>
  <verify>grep -q "Platform personas" .claude/commands/psn/voice.md</verify>
  <done>Documentation updated to explain platform persona interview</done>
</task>

</tasks>

<verification>
1. Run interview: bun run src/cli/voice-interview.ts start
2. Select X platform only, complete platform persona questions
3. Verify generated profile has platforms.x configured correctly
4. Re-run with multiple platforms, verify all platform personas are in profile
5. Check documentation is clear about platform persona flow
</verification>

<success_criteria>
- Platform personas correctly integrated into VoiceProfile from interview answers
- Default values applied when answers are missing
- Documentation explains platform selection and configuration
- Documentation includes platform-specific examples
</success_criteria>

<output>
After completion, create `.planning/phases/19-voice-profile-and-interview-refinements-p3/19-06-SUMMARY.md`
</output>
