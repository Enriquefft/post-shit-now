---
phase: 19-voice-profile-and-interview-refinements-p3
plan: 05
type: execute
wave: 2
depends_on: [19-03]
files_modified: [src/voice/profile.ts, src/cli/voice-interview.ts]
autonomous: true
requirements: [m8]

must_haves:
  truths:
    - "Timezone from profile is passed to strategy generation"
    - "CLI subcommand available for standalone timezone validation"
    - "Strategy configuration includes timezone for scheduling"
  artifacts:
    - path: "src/voice/profile.ts"
      provides: "Strategy generation with timezone integration"
      exports: ["generateStrategy"]
    - path: "src/cli/voice-interview.ts"
      provides: "CLI timezone subcommand"
  key_links:
    - from: "src/voice/profile.ts"
      to: "src/voice/types.ts"
      via: "VoiceProfile timezone field"
      pattern: "profile.timezone"
    - from: "src/cli/voice-interview.ts"
      to: "src/core/utils/timezone.ts"
      via: "isValidTimezone validation"
      pattern: "isValidTimezone\\("
---

<objective>
Pass timezone to strategy generation and add CLI timezone validation subcommand.

Purpose: Enable scheduling algorithms to use timezone and provide standalone timezone validation tool.
Output: Timezone in StrategyConfig and CLI timezone subcommand
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@src/core/utils/timezone.ts (isValidTimezone function)
@src/voice/types.ts (VoiceProfile schema with timezone field)
@src/voice/profile.ts (generateStrategy function)
@src/cli/voice-interview.ts (CLI entry point with existing commands)
</context>

<tasks>

<task type="auto">
  <name>Pass timezone to strategy generation</name>
  <files>src/voice/profile.ts</files>
  <action>
    Update generateStrategy function to incorporate timezone:

    1. Accept profile.timezone value from VoiceProfile
    2. Include timezone in generated StrategyConfig
    3. Add to strategyConfigSchema if needed (check if timezone already exists)

    Add timezone field to StrategyConfig:
    ```typescript
    export interface StrategyConfig {
      // existing fields...
      timezone?: string;
    }
    ```

    In generateStrategy, add:
    ```typescript
    timezone: profile.timezone
    ```

    This allows scheduling algorithms to use timezone for optimal posting times.

    Follow existing pattern of extending strategy from profile data (pillars, platforms, languages).
    Keep timezone optional for backward compatibility.
  </action>
  <verify>grep -q "timezone" src/voice/profile.ts | grep -q "StrategyConfig"</verify>
  <done>Timezone included in strategy configuration for scheduling</done>
</task>

<task type="auto">
  <name>Add timezone setup subcommand</name>
  <files>src/cli/voice-interview.ts</files>
  <action>
    Add CLI subcommand for standalone timezone configuration:

    Add new case to CLI entry point (import.meta.main section):
    ```typescript
    case "timezone": {
      const tz = args[1];
      if (!tz) {
        console.log(JSON.stringify({error: "Missing timezone argument"}));
        process.exit(1);
      }
      if (!isValidTimezone(tz)) {
        console.log(JSON.stringify({
          error: `Invalid timezone: ${tz}`,
          hint: "Use IANA timezone format (e.g., America/New_York)"
        }));
        process.exit(1);
      }
      console.log(JSON.stringify({
        valid: true,
        timezone: tz
      }));
      break;
    }
    ```

    Import isValidTimezone from src/core/utils/timezone.ts.

    This allows quick timezone validation without full interview:
    ```
    bun run src/cli/voice-interview.ts timezone America/New_York
    ```

    Follow existing CLI pattern (start, import, submit, complete cases).
  </action>
  <verify>grep -q 'case "timezone":' src/cli/voice-interview.ts</verify>
  <done>CLI timezone subcommand added for standalone validation</done>
</task>

</tasks>

<verification>
1. Test valid timezone: bun run src/cli/voice-interview.ts timezone America/New_York
2. Test invalid timezone: bun run src/cli/voice-interview.ts timezone Invalid/Timezone
3. Verify strategy.yaml generation includes timezone when profile has it
4. Confirm timezone subcommand returns proper JSON format
</verification>

<success_criteria>
- Strategy generation includes timezone from profile
- StrategyConfig type has timezone field
- CLI timezone subcommand validates and returns valid/invalid status
- Timezone subcommand provides helpful error messages
</success_criteria>

<output>
After completion, create `.planning/phases/19-voice-profile-and-interview-refinements-p3/19-05-SUMMARY.md`
</output>
