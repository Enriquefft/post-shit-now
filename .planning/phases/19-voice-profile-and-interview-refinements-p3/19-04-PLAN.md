---
phase: 19-voice-profile-and-interview-refinements-p3
plan: 04
type: execute
wave: 1
depends_on: []
files_modified: [src/voice/interview.ts]
autonomous: true
requirements: [m7]

must_haves:
  truths:
    - "Platform selection question allows choosing multiple platforms"
    - "Each platform has specific persona questions (tone, format, hashtags, emoji)"
    - "Platform questions only appear for selected platforms"
  artifacts:
    - path: "src/voice/interview.ts"
      provides: "Platform persona interview questions"
      exports: ["generateQuestions", "PLATFORM_QUESTIONS"]
  key_links:
    - from: "src/voice/interview.ts"
      to: "src/voice/types.ts"
      via: "PlatformPersona type for validation"
      pattern: "platformPersonaSchema"
    - from: "src/voice/interview.ts"
      to: "src/voice/interview.ts"
      via: "generateQuestions filtering logic"
      pattern: "PLATFORM_QUESTIONS.filter"
---

<objective>
Design platform persona interview questions and filtering logic for each platform (X, LinkedIn, Instagram, TikTok).

Purpose: Allow users to configure unique voices for each platform with platform-specific guidance.
Output: Platform-specific interview questions with filtering based on user selection
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@src/voice/types.ts (PlatformPersona schema with tone, formatPreferences, hashtagStyle, emojiUsage)
@src/voice/interview.ts (question generation and interview state)
@.planning/phases/08-instagram-tiktok-and-engagement/08-05-PLAN.md (platform-specific content guidance)
</context>

<tasks>

<task type="auto">
  <name>Add platform selection question</name>
  <files>src/voice/interview.ts</files>
  <action>
    Add platform selection question to interview:

    1. Create new PLATFORM_QUESTIONS array at top level
    2. Add "platform_select" question to list platforms user wants to configure
    3. Use multi-choice type for selecting multiple platforms
    4. Include X, LinkedIn, Instagram, TikTok options

    Question structure:
    ```typescript
    const PLATFORM_SELECT_QUESTION: InterviewQuestion = {
      id: "platform_select",
      phase: "platforms",
      text: "Which platforms do you want to post on?",
      hint: "You can add more platforms later via /psn:voice edit",
      type: "multi-choice",
      required: true,
      options: ["X (Twitter)", "LinkedIn", "Instagram", "TikTok"]
    };
    ```

    Add to PLATFORM_QUESTIONS array:
    ```typescript
    const PLATFORM_QUESTIONS: InterviewQuestion[] = [
      PLATFORM_SELECT_QUESTION,
      // Platform-specific questions added in next task
    ];
    ```

    This determines which follow-up platform persona questions to show.

    Follow existing question pattern (IDENTY_QUESTIONS, STYLE_QUESTIONS).
  </action>
  <verify>grep -q "PLATFORM_QUESTIONS" src/voice/interview.ts</verify>
  <done>Platform selection question added to interview</done>
</task>

<task type="auto">
  <name>Add platform-specific persona questions</name>
  <files>src/voice/interview.ts</files>
  <action>
    Add platform-specific questions to PLATFORM_QUESTIONS array:

    For each platform (X, LinkedIn, Instagram, TikTok), add persona questions:

    **X (Twitter):**
    - Tone: "What's your X persona?" (Casual, Professional, Newsy, Opinionated)
    - Hashtag style: Minimal, Strategic (1-3 per post), Heavy (5-10)
    - Emoji usage: None, Rare, Moderate, Heavy
    - Example: "Thread-heavy, concise, uses threads for deep dives"

    **LinkedIn:**
    - Tone: "What's your LinkedIn persona?" (Professional, Thought Leader, Educational, Storyteller)
    - Format preferences: Text-only, Image, Carousel, Document
    - Hashtag style: Strategic (3-5), None
    - Emoji usage: None, Rare (for emphasis only)
    - Example: "Professional but accessible, uses carousels for frameworks"

    **Instagram:**
    - Tone: "What's your Instagram persona?" (Visual, Lifestyle, Educational, Behind-the-scenes)
    - Format preferences: Photo, Carousel, Reel
    - Hashtag style: Strategic (5-10), Heavy (15-30 max)
    - Emoji usage: Moderate, Heavy (Instagram norm)
    - Example: "Visual-first, uses Reels for dynamic content, strategic hashtags"

    **TikTok:**
    - Tone: "What's your TikTok persona?" (Entertaining, Educational, Trend-focused, Authentic)
    - Format preferences: Short video (15-30s), Long video (30-60s)
    - Hashtag style: Strategic (3-5), Heavy (trending tags)
    - Emoji usage: Heavy (TikTok culture)
    - Example: "Authentic and casual, jumps on trends, heavy emoji usage"

    Each question should include:
    - id: `{platform}_{field}` (e.g., x_tone, linkedin_format)
    - phase: "platforms"
    - type: "choice" or "multi-choice"
    - required: false (platforms are optional)
    - hint: Platform-specific guidance
    - branchCondition: Only show if platform selected in platform_select

    Add all to PLATFORM_QUESTIONS array.
  </action>
  <verify>grep -c "PLATFORM_QUESTIONS" src/voice/interview.ts</verify>
  <done>All four platform persona questions added with platform-specific guidance</done>
</task>

<task type="auto">
  <name>Update generateQuestions to filter platform questions</name>
  <files>src/voice/interview.ts</files>
  <action>
    Update generateQuestions function to show platform questions based on platform_select:

    1. Read platform_select answer from state.answers
    2. Parse selected platforms from multi-choice response
    3. Filter PLATFORM_QUESTIONS to only include questions for selected platforms
    4. Add filtered questions to returned question array

    Logic:
    ```typescript
    function generateQuestions(state: InterviewState): InterviewQuestion[] {
      // ... existing question generation ...

      // Platform questions
      const platformSelect = state.answers.get("platform_select");
      if (platformSelect) {
        const selectedPlatforms = parsePlatformSelection(platformSelect);
        const platformQuestions = PLATFORM_QUESTIONS.filter(q => {
          if (q.id === "platform_select") return true;
          // Check if question belongs to selected platform
          return selectedPlatforms.some(p => q.id.startsWith(`${p}_`));
        });
        questions.push(...platformQuestions);
      }

      return questions;
    }
    ```

    This ensures users only answer questions for platforms they selected.

    Follow existing branching pattern (maturity, experience level detection).
    Use platformSelect as filter condition for platform-specific questions.
  </action>
  <verify>grep -A20 "export function generateQuestions" src/voice/interview.ts | grep -q "PLATFORM_QUESTIONS"</verify>
  <done>generateQuestions filters platform questions based on user selection</done>
</task>

</tasks>

<verification>
1. Run interview: bun run src/cli/voice-interview.ts start
2. Select X platform only
3. Verify only X-related questions appear (no LinkedIn/Instagram/TikTok questions)
4. Re-run with multiple platforms selected, verify all platform questions appear
</verification>

<success_criteria>
- Platform selection question allows choosing multiple platforms
- Each platform has specific persona questions (tone, format, hashtags, emoji)
- Questions only appear for selected platforms
- Filtering logic works correctly based on platform_select answer
</success_criteria>

<output>
After completion, create `.planning/phases/19-voice-profile-and-interview-refinements-p3/19-04-SUMMARY.md`
</output>
